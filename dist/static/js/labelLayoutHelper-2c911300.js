import{b as F,ar as P,d3 as H,au as J,ax as K,d4 as w,B as Q}from"./SeriesDataSchema-e01fbb85.js";function Z(n,e){function o(r,c){var a=[];return r.eachComponent({mainType:"series",subType:n,query:c},function(t){a.push(t.seriesIndex)}),a}F([[n+"ToggleSelect","toggleSelect"],[n+"Select","select"],[n+"UnSelect","unselect"]],function(r){e(r[0],function(c,a,t){c=P({},c),t.dispatchAction(P(c,{type:r[1],seriesIndex:o(a,c)}))})})}function k(n,e,o,r,c){var a=n+e;o.isSilent(a)||r.eachComponent({mainType:"series",subType:"pie"},function(t){for(var p=t.seriesIndex,f=t.option.selectedMap,v=c.selected,h=0;h<v.length;h++)if(v[h].seriesIndex===p){var g=t.getData(),l=H(g,c.fromActionPayload);o.trigger(a,{type:a,seriesId:t.id,name:J(l)?g.getName(l[0]):g.getName(l),selected:K(f)?f:P({},f)})}})}function _(n,e,o){n.on("selectchanged",function(r){var c=o.getModel();r.isFromClick?(k("map","selectchanged",e,c,r),k("pie","selectchanged",e,c,r)):r.fromAction==="select"?(k("map","selected",e,c,r),k("pie","selected",e,c,r)):r.fromAction==="unselect"&&(k("map","unselected",e,c,r),k("pie","unselected",e,c,r))})}function $(n){for(var e=[],o=0;o<n.length;o++){var r=n[o];if(!r.defaultAttr.ignore){var c=r.label,a=c.getComputedTransform(),t=c.getBoundingRect(),p=!a||a[1]<1e-5&&a[2]<1e-5,f=c.style.margin||0,v=t.clone();v.applyTransform(a),v.x-=f/2,v.y-=f/2,v.width+=f,v.height+=f;var h=p?new w(t,a):null;e.push({label:c,labelLine:r.labelLine,rect:v,localRect:t,obb:h,priority:r.priority,defaultAttr:r.defaultAttr,layoutOption:r.computedLayoutOption,axisAligned:p,transform:a})}}return e}function Y(n,e,o,r,c,a){var t=n.length;if(t<2)return;n.sort(function(i,A){return i.rect[e]-A.rect[e]});for(var p=0,f,v=!1,h=0,g=0;g<t;g++){var l=n[g],S=l.rect;f=S[e]-p,f<0&&(S[e]-=f,l.label[e]-=f,v=!0);var y=Math.max(-f,0);h+=y,p=S[e]+S[o]}h>0&&a&&G(-h/t,0,t);var L=n[0],O=n[t-1],q,E;B(),q<0&&M(-q,.8),E<0&&M(E,.8),B(),z(q,E,1),z(E,q,-1),B(),q<0&&U(-q),E<0&&U(E);function B(){q=L.rect[e]-r,E=c-O.rect[e]-O.rect[o]}function z(i,A,d){if(i<0){var s=Math.min(A,-i);if(s>0){G(s*d,0,t);var u=s+i;u<0&&M(-u*d,1)}else M(-i*d,1)}}function G(i,A,d){i!==0&&(v=!0);for(var s=A;s<d;s++){var u=n[s],b=u.rect;b[e]+=i,u.label[e]+=i}}function M(i,A){for(var d=[],s=0,u=1;u<t;u++){var b=n[u-1].rect,W=Math.max(n[u].rect[e]-b[e]-b[o],0);d.push(W),s+=W}if(s){var X=Math.min(Math.abs(i)/s,A);if(i>0)for(var u=0;u<t-1;u++){var N=d[u]*X;G(N,0,u+1)}else for(var u=t-1;u>0;u--){var N=d[u-1]*X;G(-N,u,t)}}}function U(i){var A=i<0?-1:1;i=Math.abs(i);for(var d=Math.ceil(i/(t-1)),s=0;s<t-1;s++)if(A>0?G(d,0,s+1):G(-d,t-s-1,t),i-=d,i<=0)return}return v}function j(n,e,o,r){return Y(n,"x","width",e,o,r)}function R(n,e,o,r){return Y(n,"y","height",e,o,r)}function C(n){var e=[];n.sort(function(L,O){return O.priority-L.priority});var o=new Q(0,0,0,0);function r(L){if(!L.ignore){var O=L.ensureState("emphasis");O.ignore==null&&(O.ignore=!1)}L.ignore=!0}for(var c=0;c<n.length;c++){var a=n[c],t=a.axisAligned,p=a.localRect,f=a.transform,v=a.label,h=a.labelLine;o.copy(a.rect),o.width-=.1,o.height-=.1,o.x+=.05,o.y+=.05;for(var g=a.obb,l=!1,S=0;S<e.length;S++){var y=e[S];if(o.intersect(y.rect)){if(t&&y.axisAligned){l=!0;break}if(y.obb||(y.obb=new w(y.localRect,y.transform)),g||(g=new w(p,f)),g.intersect(y.obb)){l=!0;break}}}l?(r(v),h&&r(h)):(v.attr("ignore",a.defaultAttr.ignore),h&&h.attr("ignore",a.defaultAttr.labelGuideIgnore),e.push(a))}}export{R as a,_ as b,Z as c,C as h,$ as p,j as s};
