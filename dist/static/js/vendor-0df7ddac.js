import{b as f,ax as k,cV as A,au as _}from"./SeriesDataSchema-e01fbb85.js";var S={},F=function(){function t(){this._coordinateSystems=[]}return t.prototype.create=function(a,n){var r=[];f(S,function(y,o){var s=y.create(a,n);r=r.concat(s||[])}),this._coordinateSystems=r},t.prototype.update=function(a,n){f(this._coordinateSystems,function(r){r.update&&r.update(a,n)})},t.prototype.getCoordinateSystems=function(){return this._coordinateSystems.slice()},t.register=function(a,n){S[a]=n},t.get=function(a){return S[a]},t}();const I=F;function L(t,a,n){n=n||{};var r=n.byIndex,y=n.stackedCoordDimension,o,s,d;b(a)?o=a:(s=a.schema,o=s.dimensions,d=a.store);var x=!!(t&&t.get("stack")),c,i,l,u;if(f(o,function(e,g){k(e)&&(o[g]=e={name:e}),x&&!e.isExtraCoord&&(!r&&!c&&e.ordinalMeta&&(c=e),!i&&e.type!=="ordinal"&&e.type!=="time"&&(!y||y===e.coordDim)&&(i=e))}),i&&!r&&!c&&(r=!0),i){l="__\0ecstackresult_"+t.id,u="__\0ecstackedover_"+t.id,c&&(c.createInvertedIndices=!0);var D=i.coordDim,m=i.type,v=0;f(o,function(e){e.coordDim===D&&v++});var C={name:l,coordDim:D,coordDimIndex:v,type:m,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:o.length},p={name:u,coordDim:u,coordDimIndex:v+1,type:m,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:o.length+1};s?(d&&(C.storeDimIndex=d.ensureCalculationDimension(u,m),p.storeDimIndex=d.ensureCalculationDimension(l,m)),s.appendCalculationDimension(C),s.appendCalculationDimension(p)):(o.push(C),o.push(p))}return{stackedDimension:i&&i.name,stackedByDimension:c&&c.name,isStackedByIndex:r,stackedOverDimension:u,stackResultDimension:l}}function b(t){return!A(t.schema)}function B(t,a){return!!a&&a===t.getCalculationInfo("stackedDimension")}function R(t,a){return B(t,a)?t.getCalculationInfo("stackResultDimension"):a}var h=typeof Float32Array<"u",E=h?Float32Array:Array;function V(t){return _(t)?h?new Float32Array(t):t:new E(t)}export{I as C,V as c,L as e,R as g,B as i};
